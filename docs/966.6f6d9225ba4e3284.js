"use strict";(self.webpackChunk_1PF_Soto=self.webpackChunk_1PF_Soto||[]).push([[966],{966:(J,F,r)=>{r.r(F),r.d(F,{CoursesModule:()=>H});var m=r(177),u=r(5743),a=r(9417),d=r(5351),v=r(5177),t=r(7705),C=r(8834),h=r(6467),E=r(9631),p=r(5084);function I(e,n){if(1&e&&(t.j41(0,"mat-error"),t.EFF(1),t.k0s()),2&e){const o=t.XpG();t.R7$(1),t.JRh(o.getErrorMessage("name"))}}let k=(()=>{class e{constructor(o,s,i){this.fb=o,this.MatDialogRef=s,this.data=i,this.existingIds=[],this.courseForm=this.fb.group({name:["",[a.k0.required,a.k0.minLength(3),a.k0.maxLength(20),a.k0.pattern(/^[^\d]*$/)]],startDate:["",[a.k0.required]],endDate:["",[a.k0.required]]}),this.patchFormValue()}getErrorMessage(o){return v.F.getErrorMessage(this.courseForm,o)}hasError(o){return v.F.hasError(this.courseForm,o)}onSave(){this.courseForm.invalid?this.courseForm.markAllAsTouched():this.MatDialogRef.close({...this.courseForm.value,id:this.isEditing?this.data.editingCourse.id:this.generateUniqueId()})}patchFormValue(){this.data?.editingCourse&&this.courseForm.patchValue(this.data.editingCourse)}generateUniqueId(){let o=Math.floor(9e3*Math.random())+1e3;for(;this.existingIds.includes(o);)o=Math.floor(9e3*Math.random())+1e3;return this.existingIds.push(o),o}get isEditing(){return!!this.data?.editingCourse}static{this.\u0275fac=function(s){return new(s||e)(t.rXU(a.ok),t.rXU(d.CP),t.rXU(d.Vh))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-courses-modal"]],decls:28,vars:5,consts:[[1,"container"],["mat-dialog-title","",1,"text-white"],["mat-dialog-content",""],[3,"formGroup"],[1,"row","g-3"],[1,"col-12","col-md-6"],["appearance","outline"],["matInput","","placeholder","Titulo del curso","formControlName","name"],[4,"ngIf"],[3,"rangePicker"],["matStartDate","","formControlName","startDate","placeholder","Fecha inicio"],["matEndDate","","formControlName","endDate","placeholder","Fecha fin"],[2,"color","#fff"],["matIconSuffix","",3,"for"],["picker",""],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close","",1,"mx-3"],["mat-flat-button","","color","primary",3,"click"]],template:function(s,i){if(1&s&&(t.j41(0,"div",0)(1,"h1",1),t.EFF(2),t.k0s(),t.j41(3,"div",2)(4,"form",3)(5,"div",4)(6,"div",5)(7,"mat-form-field",6)(8,"mat-label"),t.EFF(9,"Titulo del curso"),t.k0s(),t.nrm(10,"input",7),t.DNE(11,I,2,1,"mat-error",8),t.k0s()(),t.j41(12,"mat-form-field",6)(13,"mat-label"),t.EFF(14,"Fecha inicio - Fecha fin"),t.k0s(),t.j41(15,"mat-date-range-input",9),t.nrm(16,"input",10)(17,"input",11),t.k0s(),t.j41(18,"mat-hint",12),t.EFF(19,"MM/DD/YYYY \u2013 MM/DD/YYYY"),t.k0s(),t.nrm(20,"mat-datepicker-toggle",13)(21,"mat-date-range-picker",null,14),t.k0s()()()(),t.j41(23,"div",15)(24,"button",16),t.EFF(25,"Cancelar"),t.k0s(),t.j41(26,"button",17),t.bIt("click",function(){return i.onSave()}),t.EFF(27,"Guardar"),t.k0s()()()),2&s){const c=t.sdS(22);t.R7$(2),t.SpI("",null!=i.data&&i.data.editingCourse?"Editando":"Creando"," curso"),t.R7$(2),t.Y8G("formGroup",i.courseForm),t.R7$(7),t.Y8G("ngIf",i.hasError("name")),t.R7$(4),t.Y8G("rangePicker",c),t.R7$(5),t.Y8G("for",c)}},dependencies:[m.bT,C.$z,h.rl,h.nJ,h.MV,h.TL,h.yw,a.qT,a.me,a.BC,a.cb,a.j4,a.JD,E.fg,p.bU,p.el,p.xR,p.IG,p.SG,d.tx,d.BI,d.Yi,d.E7],styles:[".container[_ngcontent-%COMP%]{height:-moz-fit-content!important;height:fit-content!important;width:-moz-fit-content!important;width:fit-content!important;padding:32px}"]})}}return e})();var D=r(8769),b=r(9213),l=r(9159),_=r(9183);function x(e,n){1&e&&t.nrm(0,"mat-spinner")}function j(e,n){1&e&&(t.j41(0,"th",14),t.EFF(1," ID "),t.k0s())}function T(e,n){if(1&e&&(t.j41(0,"td",15),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.R7$(1),t.SpI(" ",o.id," ")}}function R(e,n){1&e&&(t.j41(0,"th",14),t.EFF(1," Nombre "),t.k0s())}function $(e,n){if(1&e&&(t.j41(0,"td",15),t.EFF(1),t.k0s()),2&e){const o=n.$implicit;t.R7$(1),t.SpI(" ",o.name," ")}}function M(e,n){1&e&&(t.j41(0,"th",14),t.EFF(1," Comienzo "),t.k0s())}function G(e,n){if(1&e&&(t.j41(0,"td",15),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&e){const o=n.$implicit;t.R7$(1),t.SpI(" ",t.bMT(2,1,o.startDate)," ")}}function N(e,n){1&e&&(t.j41(0,"th",14),t.EFF(1," Final "),t.k0s())}function L(e,n){if(1&e&&(t.j41(0,"td",15),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&e){const o=n.$implicit;t.R7$(1),t.SpI(" ",t.bMT(2,1,o.endDate)," ")}}function S(e,n){1&e&&(t.j41(0,"th",14),t.EFF(1," Acciones "),t.k0s())}function Y(e,n){if(1&e){const o=t.RV6();t.j41(0,"td",15)(1,"button",16),t.bIt("click",function(){const c=t.eBV(o).$implicit,f=t.XpG(2);return t.Njj(f.onDelete(c.id))}),t.j41(2,"mat-icon"),t.EFF(3,"delete"),t.k0s()(),t.j41(4,"button",16),t.bIt("click",function(){const c=t.eBV(o).$implicit,f=t.XpG(2);return t.Njj(f.openModal(c))}),t.j41(5,"mat-icon"),t.EFF(6,"edit"),t.k0s()(),t.j41(7,"button",16),t.bIt("click",function(){const c=t.eBV(o).$implicit,f=t.XpG(2);return t.Njj(f.goToDetail(c.id))}),t.j41(8,"mat-icon"),t.EFF(9,"info"),t.k0s()()()}}function y(e,n){1&e&&t.nrm(0,"tr",17)}function V(e,n){1&e&&t.nrm(0,"tr",18)}function U(e,n){if(1&e&&(t.j41(0,"div")(1,"table",4),t.qex(2,5),t.DNE(3,j,2,0,"th",6),t.DNE(4,T,2,1,"td",7),t.bVm(),t.qex(5,8),t.DNE(6,R,2,0,"th",6),t.DNE(7,$,2,1,"td",7),t.bVm(),t.qex(8,9),t.DNE(9,M,2,0,"th",6),t.DNE(10,G,3,3,"td",7),t.bVm(),t.qex(11,10),t.DNE(12,N,2,0,"th",6),t.DNE(13,L,3,3,"td",7),t.bVm(),t.qex(14,11),t.DNE(15,S,2,0,"th",6),t.DNE(16,Y,10,0,"td",7),t.bVm(),t.DNE(17,y,1,0,"tr",12),t.DNE(18,V,1,0,"tr",13),t.k0s()()),2&e){const o=t.XpG();t.R7$(1),t.Y8G("dataSource",o.courses),t.R7$(16),t.Y8G("matHeaderRowDef",o.displayedColumns),t.R7$(1),t.Y8G("matRowDefColumns",o.displayedColumns)}}let X=(()=>{class e{constructor(o,s,i,c){this.courseService=o,this.matDialog=s,this.router=i,this.activatedRoute=c,this.courses=[],this.isLoading=!0,this.displayedColumns=["id","name","startDate","endDate","actions"]}ngOnInit(){this.loadCourses()}loadCourses(){this.courseService.getCourses().subscribe({next:o=>{this.courses=o,this.isLoading=!1},error:()=>{this.isLoading=!1,console.error("Error al cargar los cursos")},complete:()=>{this.isLoading=!1}})}openModal(o){this.matDialog.open(k,{data:{editingCourse:o}}).afterClosed().subscribe({next:s=>{s&&(o?this.handleUpdate(o.id,s):(this.courseService.addCourses(s).subscribe({next:()=>this.loadCourses()}),console.log(s)))}})}handleUpdate(o,s){this.isLoading=!0,this.courseService.updateCoursesById(o,s).subscribe({next:i=>{this.courses=i},error:()=>{this.isLoading=!1},complete:()=>{this.isLoading=!1}})}onDelete(o){this.isLoading=!0,confirm("\xbfEst\xe1 seguro?")&&this.courseService.removeCoursesById(o).subscribe({next:s=>{this.courses=s},error:s=>{console.error(s),this.isLoading=!1},complete:()=>{this.isLoading=!1}})}goToDetail(o){this.router.navigate([o,"detail"],{relativeTo:this.activatedRoute})}static{this.\u0275fac=function(s){return new(s||e)(t.rXU(D.f),t.rXU(d.bZ),t.rXU(u.Ix),t.rXU(u.nX))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-courses"]],decls:10,vars:2,consts:[[1,"m-4"],[1,"mb-5"],["mat-fab","","extended","","color","secondary",3,"click"],[4,"ngIf"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","startDate"],["matColumnDef","endDate"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(s,i){1&s&&(t.j41(0,"div",0)(1,"h1"),t.EFF(2,"Administrar cursos"),t.k0s(),t.j41(3,"div",1)(4,"button",2),t.bIt("click",function(){return i.openModal()}),t.j41(5,"mat-icon"),t.EFF(6,"add"),t.k0s(),t.EFF(7," A\xf1adir curso "),t.k0s()(),t.DNE(8,x,1,0,"mat-spinner",3),t.DNE(9,U,19,3,"div",3),t.k0s()),2&s&&(t.R7$(8),t.Y8G("ngIf",i.isLoading),t.R7$(1),t.Y8G("ngIf",!i.isLoading))},dependencies:[m.bT,C.iY,C.Sr,b.An,l.Zl,l.tL,l.ji,l.cC,l.YV,l.iL,l.KS,l.$R,l.YZ,l.NB,_.LG,m.vh]})}}return e})();var g=r(5596);function B(e,n){1&e&&t.nrm(0,"mat-spinner")}function w(e,n){if(1&e&&(t.j41(0,"div")(1,"mat-card")(2,"mat-card-title"),t.EFF(3),t.k0s(),t.j41(4,"mat-card-content"),t.nrm(5,"div"),t.k0s()()()),2&e){const o=t.XpG();t.R7$(3),t.SpI(" Detalles del curso ",null==o.course?null:o.course.name," ")}}const A=[{path:"",component:X},{path:":id/detail",component:(()=>{class e{constructor(o,s){this.courseService=o,this.activatedRoute=s,this.isLoading=!0}ngOnInit(){this.courseId=Number(this.activatedRoute.snapshot.params.id),console.log("Course ID:",this.courseId),this.courseId&&this.loadCourseDetails(this.courseId)}loadCourseDetails(o){this.courseService.getCourseById(o).subscribe({next:s=>{this.isLoading=!1,this.course=s},error:s=>{this.isLoading=!1,console.error(s)},complete:()=>{this.isLoading=!1}})}static{this.\u0275fac=function(s){return new(s||e)(t.rXU(D.f),t.rXU(u.nX))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-courses-detail"]],decls:2,vars:2,consts:[[4,"ngIf"]],template:function(s,i){1&s&&(t.DNE(0,B,1,0,"mat-spinner",0),t.DNE(1,w,6,1,"div",0)),2&s&&(t.Y8G("ngIf",i.isLoading),t.R7$(1),t.Y8G("ngIf",!i.isLoading))},dependencies:[m.bT,_.LG,g.RN,g.m2,g.dh]})}}return e})()},{path:"**",redirectTo:""}];let P=(()=>{class e{static{this.\u0275fac=function(s){return new(s||e)}}static{this.\u0275mod=t.$C({type:e})}static{this.\u0275inj=t.G2t({imports:[u.iI.forChild(A),u.iI]})}}return e})();var z=r(3887);let H=(()=>{class e{static{this.\u0275fac=function(s){return new(s||e)}}static{this.\u0275mod=t.$C({type:e})}static{this.\u0275inj=t.G2t({imports:[m.MD,P,z.G]})}}return e})()}}]);